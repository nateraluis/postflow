{% load static %}

<div class="px-4 sm:px-6 lg:px-8 py-8">
  <!-- Header -->
  <div class="sm:flex sm:items-center mb-6">
    <div class="sm:flex-auto">
      <h1 class="text-2xl font-semibold text-gray-900">Post Analytics</h1>
      <p class="mt-2 text-sm text-gray-700">Detailed analytics for this post across all platforms</p>
    </div>
    <div class="mt-4 sm:ml-16 sm:mt-0 sm:flex-none">
      <a href="{% url 'analytics:dashboard' %}"
         class="inline-flex items-center justify-center rounded-md bg-gray-600 px-3 py-2 text-sm font-semibold text-white shadow-sm hover:bg-gray-500">
        Back to Dashboard
      </a>
    </div>
  </div>

  <!-- Post Info -->
  <div class="mb-8 bg-white shadow rounded-lg overflow-hidden">
    <div class="px-6 py-4">
      <div class="flex items-start space-x-4">
        {% if post.image %}
          <img src="{{ post.image.url }}" alt="Post image" class="w-24 h-24 object-cover rounded-lg">
        {% endif %}
        <div class="flex-1">
          <p class="text-gray-900 font-medium mb-2">{{ post.caption|truncatewords:50 }}</p>
          <p class="text-sm text-gray-500">Posted: {{ post.post_date|date:"M d, Y g:i A" }}</p>
        </div>
      </div>
    </div>
  </div>

  <!-- Analytics by Platform -->
  <div class="grid grid-cols-1 gap-6">
    {% for analytic in analytics %}
    <div class="bg-white shadow rounded-lg overflow-hidden">
      <div class="px-6 py-4 border-b border-gray-200">
        <h3 class="text-lg font-semibold text-gray-900">{{ analytic.get_platform_display }}</h3>
        <p class="text-sm text-gray-500">Last updated: {{ analytic.last_updated|date:"M d, Y g:i A" }}</p>
      </div>
      <div class="px-6 py-4">
        <dl class="grid grid-cols-2 gap-4 sm:grid-cols-3 lg:grid-cols-5">
          <div>
            <dt class="text-sm font-medium text-gray-500">Likes</dt>
            <dd class="mt-1 text-2xl font-semibold text-gray-900">{{ analytic.likes }}</dd>
          </div>
          <div>
            <dt class="text-sm font-medium text-gray-500">Comments</dt>
            <dd class="mt-1 text-2xl font-semibold text-gray-900">{{ analytic.comments }}</dd>
          </div>
          <div>
            <dt class="text-sm font-medium text-gray-500">Shares</dt>
            <dd class="mt-1 text-2xl font-semibold text-gray-900">{{ analytic.shares }}</dd>
          </div>
          {% if analytic.impressions %}
          <div>
            <dt class="text-sm font-medium text-gray-500">Impressions</dt>
            <dd class="mt-1 text-2xl font-semibold text-gray-900">{{ analytic.impressions }}</dd>
          </div>
          {% endif %}
          {% if analytic.reach %}
          <div>
            <dt class="text-sm font-medium text-gray-500">Reach</dt>
            <dd class="mt-1 text-2xl font-semibold text-gray-900">{{ analytic.reach }}</dd>
          </div>
          {% endif %}
          {% if analytic.saved %}
          <div>
            <dt class="text-sm font-medium text-gray-500">Saved</dt>
            <dd class="mt-1 text-2xl font-semibold text-gray-900">{{ analytic.saved }}</dd>
          </div>
          {% endif %}
          {% if analytic.engagement_rate %}
          <div>
            <dt class="text-sm font-medium text-gray-500">Engagement Rate</dt>
            <dd class="mt-1 text-2xl font-semibold text-gray-900">{{ analytic.engagement_rate }}%</dd>
          </div>
          {% endif %}
        </dl>
        <div class="mt-4">
          <p class="text-sm text-gray-700">Total Engagement: <span class="font-semibold">{{ analytic.total_engagement }}</span></p>
        </div>
      </div>
    </div>
    {% empty %}
    <div class="bg-white shadow rounded-lg overflow-hidden">
      <div class="px-6 py-12 text-center">
        <p class="text-gray-500">No analytics available for this post yet.</p>
        <p class="text-sm text-gray-400 mt-2">Analytics are fetched automatically every 6 hours.</p>
      </div>
    </div>
    {% endfor %}
  </div>
</div>
