{% load analytics_filters %}
<!-- Table Headers with Sort Indicators -->
<thead class="bg-gray-50">
    <tr>
        <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
            Rank
        </th>
        <th scope="col"
            class="group px-6 py-3 text-left text-xs font-medium {% if sort_by == 'username' %}text-violet-700 bg-violet-50{% else %}text-gray-500{% endif %} uppercase tracking-wider cursor-pointer hover:bg-gray-100 transition-colors select-none relative"
            hx-get="?sort=username&order={% if sort_by == 'username' and sort_order == 'asc' %}desc{% else %}asc{% endif %}"
            hx-target="#engagers-table"
            hx-swap="innerHTML"
            hx-indicator="#sort-indicator"
            title="{% if sort_by == 'username' %}{% if sort_order == 'asc' %}Sort by descending{% else %}Sort by ascending{% endif %}{% else %}Sort by ascending{% endif %}">
            <div class="flex items-center justify-between">
                <span>User</span>
                <div class="flex flex-col ml-1">
                    {% if sort_by == 'username' and sort_order == 'asc' %}
                        <svg class="w-3 h-3 text-violet-600" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M14.707 12.707a1 1 0 01-1.414 0L10 9.414l-3.293 3.293a1 1 0 01-1.414-1.414l4-4a1 1 0 011.414 0l4 4a1 1 0 010 1.414z" clip-rule="evenodd"/>
                        </svg>
                        <svg class="w-3 h-3 text-gray-300" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z" clip-rule="evenodd"/>
                        </svg>
                    {% elif sort_by == 'username' and sort_order == 'desc' %}
                        <svg class="w-3 h-3 text-gray-300" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M14.707 12.707a1 1 0 01-1.414 0L10 9.414l-3.293 3.293a1 1 0 01-1.414-1.414l4-4a1 1 0 011.414 0l4 4a1 1 0 010 1.414z" clip-rule="evenodd"/>
                        </svg>
                        <svg class="w-3 h-3 text-violet-600" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z" clip-rule="evenodd"/>
                        </svg>
                    {% else %}
                        <svg class="w-3 h-3 text-gray-300 group-hover:text-gray-500 transition-colors" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M14.707 12.707a1 1 0 01-1.414 0L10 9.414l-3.293 3.293a1 1 0 01-1.414-1.414l4-4a1 1 0 011.414 0l4 4a1 1 0 010 1.414z" clip-rule="evenodd"/>
                        </svg>
                        <svg class="w-3 h-3 text-gray-300 group-hover:text-gray-500 transition-colors" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z" clip-rule="evenodd"/>
                        </svg>
                    {% endif %}
                </div>
            </div>
        </th>
        <th scope="col"
            class="group px-6 py-3 text-center text-xs font-medium {% if sort_by == 'likes' %}text-violet-700 bg-violet-50{% else %}text-gray-500{% endif %} uppercase tracking-wider cursor-pointer hover:bg-gray-100 transition-colors select-none"
            hx-get="?sort=likes&order={% if sort_by == 'likes' and sort_order == 'desc' %}asc{% else %}desc{% endif %}"
            hx-target="#engagers-table"
            hx-swap="innerHTML"
            hx-indicator="#sort-indicator"
            title="{% if sort_by == 'likes' %}{% if sort_order == 'asc' %}Sort by descending{% else %}Sort by ascending{% endif %}{% else %}Sort by descending{% endif %}">
            <div class="flex items-center justify-center">
                <span>{% if platform.slug == 'mastodon' %}Favourites{% else %}Likes{% endif %}</span>
                <div class="flex flex-col ml-1">
                    {% if sort_by == 'likes' and sort_order == 'asc' %}
                        <svg class="w-3 h-3 text-violet-600" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M14.707 12.707a1 1 0 01-1.414 0L10 9.414l-3.293 3.293a1 1 0 01-1.414-1.414l4-4a1 1 0 011.414 0l4 4a1 1 0 010 1.414z" clip-rule="evenodd"/>
                        </svg>
                        <svg class="w-3 h-3 text-gray-300" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z" clip-rule="evenodd"/>
                        </svg>
                    {% elif sort_by == 'likes' and sort_order == 'desc' %}
                        <svg class="w-3 h-3 text-gray-300" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M14.707 12.707a1 1 0 01-1.414 0L10 9.414l-3.293 3.293a1 1 0 01-1.414-1.414l4-4a1 1 0 011.414 0l4 4a1 1 0 010 1.414z" clip-rule="evenodd"/>
                        </svg>
                        <svg class="w-3 h-3 text-violet-600" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z" clip-rule="evenodd"/>
                        </svg>
                    {% else %}
                        <svg class="w-3 h-3 text-gray-300 group-hover:text-gray-500 transition-colors" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M14.707 12.707a1 1 0 01-1.414 0L10 9.414l-3.293 3.293a1 1 0 01-1.414-1.414l4-4a1 1 0 011.414 0l4 4a1 1 0 010 1.414z" clip-rule="evenodd"/>
                        </svg>
                        <svg class="w-3 h-3 text-gray-300 group-hover:text-gray-500 transition-colors" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z" clip-rule="evenodd"/>
                        </svg>
                    {% endif %}
                </div>
            </div>
        </th>
        <th scope="col"
            class="group px-6 py-3 text-center text-xs font-medium {% if sort_by == 'comments' %}text-violet-700 bg-violet-50{% else %}text-gray-500{% endif %} uppercase tracking-wider cursor-pointer hover:bg-gray-100 transition-colors select-none"
            hx-get="?sort=comments&order={% if sort_by == 'comments' and sort_order == 'desc' %}asc{% else %}desc{% endif %}"
            hx-target="#engagers-table"
            hx-swap="innerHTML"
            hx-indicator="#sort-indicator"
            title="{% if sort_by == 'comments' %}{% if sort_order == 'asc' %}Sort by descending{% else %}Sort by ascending{% endif %}{% else %}Sort by descending{% endif %}">
            <div class="flex items-center justify-center">
                <span>{% if platform.slug == 'mastodon' %}Replies{% else %}Comments{% endif %}</span>
                <div class="flex flex-col ml-1">
                    {% if sort_by == 'comments' and sort_order == 'asc' %}
                        <svg class="w-3 h-3 text-violet-600" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M14.707 12.707a1 1 0 01-1.414 0L10 9.414l-3.293 3.293a1 1 0 01-1.414-1.414l4-4a1 1 0 011.414 0l4 4a1 1 0 010 1.414z" clip-rule="evenodd"/>
                        </svg>
                        <svg class="w-3 h-3 text-gray-300" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z" clip-rule="evenodd"/>
                        </svg>
                    {% elif sort_by == 'comments' and sort_order == 'desc' %}
                        <svg class="w-3 h-3 text-gray-300" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M14.707 12.707a1 1 0 01-1.414 0L10 9.414l-3.293 3.293a1 1 0 01-1.414-1.414l4-4a1 1 0 011.414 0l4 4a1 1 0 010 1.414z" clip-rule="evenodd"/>
                        </svg>
                        <svg class="w-3 h-3 text-violet-600" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z" clip-rule="evenodd"/>
                        </svg>
                    {% else %}
                        <svg class="w-3 h-3 text-gray-300 group-hover:text-gray-500 transition-colors" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M14.707 12.707a1 1 0 01-1.414 0L10 9.414l-3.293 3.293a1 1 0 01-1.414-1.414l4-4a1 1 0 011.414 0l4 4a1 1 0 010 1.414z" clip-rule="evenodd"/>
                        </svg>
                        <svg class="w-3 h-3 text-gray-300 group-hover:text-gray-500 transition-colors" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z" clip-rule="evenodd"/>
                        </svg>
                    {% endif %}
                </div>
            </div>
        </th>
        <th scope="col"
            class="group px-6 py-3 text-center text-xs font-medium {% if sort_by == 'shares' %}text-violet-700 bg-violet-50{% else %}text-gray-500{% endif %} uppercase tracking-wider cursor-pointer hover:bg-gray-100 transition-colors select-none"
            hx-get="?sort=shares&order={% if sort_by == 'shares' and sort_order == 'desc' %}asc{% else %}desc{% endif %}"
            hx-target="#engagers-table"
            hx-swap="innerHTML"
            hx-indicator="#sort-indicator"
            title="{% if sort_by == 'shares' %}{% if sort_order == 'asc' %}Sort by descending{% else %}Sort by ascending{% endif %}{% else %}Sort by descending{% endif %}">
            <div class="flex items-center justify-center">
                <span>{% if platform.slug == 'mastodon' %}Reblogs{% else %}Shares{% endif %}</span>
                <div class="flex flex-col ml-1">
                    {% if sort_by == 'shares' and sort_order == 'asc' %}
                        <svg class="w-3 h-3 text-violet-600" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M14.707 12.707a1 1 0 01-1.414 0L10 9.414l-3.293 3.293a1 1 0 01-1.414-1.414l4-4a1 1 0 011.414 0l4 4a1 1 0 010 1.414z" clip-rule="evenodd"/>
                        </svg>
                        <svg class="w-3 h-3 text-gray-300" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z" clip-rule="evenodd"/>
                        </svg>
                    {% elif sort_by == 'shares' and sort_order == 'desc' %}
                        <svg class="w-3 h-3 text-gray-300" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M14.707 12.707a1 1 0 01-1.414 0L10 9.414l-3.293 3.293a1 1 0 01-1.414-1.414l4-4a1 1 0 011.414 0l4 4a1 1 0 010 1.414z" clip-rule="evenodd"/>
                        </svg>
                        <svg class="w-3 h-3 text-violet-600" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z" clip-rule="evenodd"/>
                        </svg>
                    {% else %}
                        <svg class="w-3 h-3 text-gray-300 group-hover:text-gray-500 transition-colors" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M14.707 12.707a1 1 0 01-1.414 0L10 9.414l-3.293 3.293a1 1 0 01-1.414-1.414l4-4a1 1 0 011.414 0l4 4a1 1 0 010 1.414z" clip-rule="evenodd"/>
                        </svg>
                        <svg class="w-3 h-3 text-gray-300 group-hover:text-gray-500 transition-colors" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z" clip-rule="evenodd"/>
                        </svg>
                    {% endif %}
                </div>
            </div>
        </th>
        <th scope="col"
            class="group px-6 py-3 text-center text-xs font-medium {% if sort_by == 'total_interactions' %}text-violet-700 bg-violet-50{% else %}text-gray-500{% endif %} uppercase tracking-wider cursor-pointer hover:bg-gray-100 transition-colors select-none"
            hx-get="?sort=total_interactions&order={% if sort_by == 'total_interactions' and sort_order == 'desc' %}asc{% else %}desc{% endif %}"
            hx-target="#engagers-table"
            hx-swap="innerHTML"
            hx-indicator="#sort-indicator"
            title="{% if sort_by == 'total_interactions' %}{% if sort_order == 'asc' %}Sort by descending{% else %}Sort by ascending{% endif %}{% else %}Sort by descending{% endif %}">
            <div class="flex items-center justify-center">
                <span>Total</span>
                <div class="flex flex-col ml-1">
                    {% if sort_by == 'total_interactions' and sort_order == 'asc' %}
                        <svg class="w-3 h-3 text-violet-600" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M14.707 12.707a1 1 0 01-1.414 0L10 9.414l-3.293 3.293a1 1 0 01-1.414-1.414l4-4a1 1 0 011.414 0l4 4a1 1 0 010 1.414z" clip-rule="evenodd"/>
                        </svg>
                        <svg class="w-3 h-3 text-gray-300" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z" clip-rule="evenodd"/>
                        </svg>
                    {% elif sort_by == 'total_interactions' and sort_order == 'desc' %}
                        <svg class="w-3 h-3 text-gray-300" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M14.707 12.707a1 1 0 01-1.414 0L10 9.414l-3.293 3.293a1 1 0 01-1.414-1.414l4-4a1 1 0 011.414 0l4 4a1 1 0 010 1.414z" clip-rule="evenodd"/>
                        </svg>
                        <svg class="w-3 h-3 text-violet-600" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z" clip-rule="evenodd"/>
                        </svg>
                    {% else %}
                        <svg class="w-3 h-3 text-gray-300 group-hover:text-gray-500 transition-colors" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M14.707 12.707a1 1 0 01-1.414 0L10 9.414l-3.293 3.293a1 1 0 01-1.414-1.414l4-4a1 1 0 011.414 0l4 4a1 1 0 010 1.414z" clip-rule="evenodd"/>
                        </svg>
                        <svg class="w-3 h-3 text-gray-300 group-hover:text-gray-500 transition-colors" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z" clip-rule="evenodd"/>
                        </svg>
                    {% endif %}
                </div>
            </div>
        </th>
        <th scope="col"
            class="group px-6 py-3 text-center text-xs font-medium {% if sort_by == 'engagement_score' %}text-violet-700 bg-violet-50{% else %}text-gray-500{% endif %} uppercase tracking-wider cursor-pointer hover:bg-gray-100 transition-colors select-none"
            hx-get="?sort=engagement_score&order={% if sort_by == 'engagement_score' and sort_order == 'desc' %}asc{% else %}desc{% endif %}"
            hx-target="#engagers-table"
            hx-swap="innerHTML"
            hx-indicator="#sort-indicator"
            title="{% if sort_by == 'engagement_score' %}{% if sort_order == 'asc' %}Sort by descending{% else %}Sort by ascending{% endif %}{% else %}Sort by descending{% endif %}">
            <div class="flex items-center justify-center">
                <span>Score</span>
                <div class="flex flex-col ml-1">
                    {% if sort_by == 'engagement_score' and sort_order == 'asc' %}
                        <svg class="w-3 h-3 text-violet-600" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M14.707 12.707a1 1 0 01-1.414 0L10 9.414l-3.293 3.293a1 1 0 01-1.414-1.414l4-4a1 1 0 011.414 0l4 4a1 1 0 010 1.414z" clip-rule="evenodd"/>
                        </svg>
                        <svg class="w-3 h-3 text-gray-300" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z" clip-rule="evenodd"/>
                        </svg>
                    {% elif sort_by == 'engagement_score' and sort_order == 'desc' %}
                        <svg class="w-3 h-3 text-gray-300" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M14.707 12.707a1 1 0 01-1.414 0L10 9.414l-3.293 3.293a1 1 0 01-1.414-1.414l4-4a1 1 0 011.414 0l4 4a1 1 0 010 1.414z" clip-rule="evenodd"/>
                        </svg>
                        <svg class="w-3 h-3 text-violet-600" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z" clip-rule="evenodd"/>
                        </svg>
                    {% else %}
                        <svg class="w-3 h-3 text-gray-300 group-hover:text-gray-500 transition-colors" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M14.707 12.707a1 1 0 01-1.414 0L10 9.414l-3.293 3.293a1 1 0 01-1.414-1.414l4-4a1 1 0 011.414 0l4 4a1 1 0 010 1.414z" clip-rule="evenodd"/>
                        </svg>
                        <svg class="w-3 h-3 text-gray-300 group-hover:text-gray-500 transition-colors" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z" clip-rule="evenodd"/>
                        </svg>
                    {% endif %}
                </div>
            </div>
        </th>
    </tr>
</thead>
<tbody class="bg-white divide-y divide-gray-200">
    {% include 'analytics/shared/partials/engagers_tbody.html' %}
</tbody>
