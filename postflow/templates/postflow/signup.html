{% extends "postflow/_base_web.html" %}
{% load i18n %}
{% load static %}

{% block main %}
<div class="flex min-h-full flex-col justify-center px-6 py-12 lg:px-8">
  <div class="sm:mx-auto sm:w-full sm:max-w-sm">
    <img class="mx-auto h-10 w-auto" src="{% static 'postflow/icons/logo.png' %}" alt="PostFlow">
    <h2 class="mt-10 text-center text-2xl/9 font-bold tracking-tight text-gray-900">Create your account</h2>
    {% if from_preview %}
    <p class="mt-4 text-center text-sm text-indigo-600 bg-indigo-50 px-4 py-2 rounded-lg">
      âœ¨ You're registering from your analytics preview for @{{ preview_username }}
    </p>
    {% endif %}
  </div>
  <div class="mt-10 sm:mx-auto sm:w-full sm:max-w-sm">
    <form method="POST" hx-post="{% url 'register' %}" hx-trigger="submit" hx-push-url="true" hx-target="#main">
      {% csrf_token %}
      
      {% if form.non_field_errors %}
      <div class="bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative mb-4" role="alert">
        {{ form.non_field_errors }}
      </div>
      {% endif %}
      
      <div>
        <label for="email" class="block text-sm/6 font-medium text-gray-900">Email address</label>
        <div class="mt-2">
          {{ form.email }}
          {{ form.email.errors }}
        </div>
      </div>

      <div>
        <label for="fname" class="block text-sm/6 font-medium text-gray-900">First name</label>
        <div class="mt-2">
          {{ form.first_name }}
          {{ form.first_name.errors }}
        </div>
      </div>

      <div>
        <label for="lname" class="block text-sm/6 font-medium text-gray-900">Last name</label>
        <div class="mt-2">
          {{ form.last_name }}
          {{ form.last_name.errors }}
        </div>
      </div>

      <div>
        <label for="password1" class="block text-sm/6 font-medium text-gray-900">Password</label>
        <div class="mt-2">
          {{ form.password1 }}
          {{ form.password1.errors }}
        </div>
      </div>

      <div>
        <label for="password2" class="block text-sm/6 font-medium text-gray-900">Confirm Password</label>
        <div class="mt-2">
          {{ form.password2 }}
          {{ form.password2.errors }}
        </div>
      </div>

      <div>
        <button type="submit" name="submit" class="flex w-full justify-center rounded-md bg-indigo-600 px-3 py-1.5 text-sm/6 font-semibold text-white shadow-sm hover:bg-indigo-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-600">Register</button>
      </div>
      
      <p class="mt-10 text-center text-sm/6 text-gray-500">
        Already registered?
        <a href="{% url 'login' %}" class="font-semibold text-indigo-600 hover:text-indigo-500">Log in</a>
      </p>
    </form>
  </div>
</div>

{% if from_preview %}
<script>
// Track preview conversion
if (typeof plausible !== 'undefined') {
    plausible('Preview Conversion', {
        props: {
            source: 'analytics_preview'
        }
    });
}
</script>
{% endif %}
{% endblock %}

